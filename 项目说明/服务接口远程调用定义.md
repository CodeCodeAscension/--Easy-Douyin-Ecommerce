# 服务接口远程调用定义（来自项目说明文档）

这里简要定义了主要的七个服务的RPC函数原型，将原文档的ProtoBuf转写成Java代码。

已经将这些接口服务写在了ecommerce-feign-api模块中，按照Java命名的习惯修改了部分命名，因此以ecommerce-feign-api模块为主。

各个微服务需要实现自己的服务，供其他微服务调用。

## 1、认证服务

```java
class DeliverTokenReq {
    Integer userId = 0;
}
class VerifyTokenReq {
    String token = "emtp";
}
class DeliveryResp {
    String token = "emtp";
}
class VerifyResp {
    Boolean res = false;
}

public interface AuthService {
    DeliveryResp DeliverTokenByRPC(DeliverTokenReq);
    VerifyResp VerifyTokenByRPC(VerifyTokenReq);
}
```

## 2、用户服务

```java
class RegisterReq {
    String email;
    String password;
    String confirmPassword;
}

class RegisterResp {
    Integer userId;
}

class LoginReq {
    String email;
    String password;
}

class LoginResp {
    Integer userId;
}

public interface UserService {
    RegisterResp Register(RegisterReq);
    LoginResp Login(LoginReq);
}
```

## 3、商品服务

```java
import java.util.List;

class ListProductsReq {
    Integer page;
    Long pageSize;
    String categoryName;
}

class Product {
    Integer id;
    String name;
    String description;
    String picture;
    Float price;
    List<String> categories;
}

class ListProductsResp {
    List<Product> products;
}
class GetProductReq {
    Integer id;
}
class GetProductResp {
    Product product;
}
class SearchProductsReq {
    String query;
}
class SearchProductsResp {
    List<Product> results;
}

public interface ProductCatalogService {
    ListProductsResp ListProducts(ListProductsReq);

    GetProductResp GetProduct(GetProductReq);

    SearchProductsResp SearchProducts(SearchProductsReq);
}
```

## 4、购物车服务

```java
import java.util.List;

class CartItem {
    Integer productId;
    Integer quantity;
}

class AddItemReq {
    Integer userId;
    CartItem item;
}

class AddItemResp {

}

class EmptyCartReq {
    Integer userId;
}

class GetCartReq {
    Integer userId;
}

class GetCartResp {
    Cart cart;
}

class Cart {
    Integer userId;
    List<CartItem> items;
}

class EmptyCartResp {

}

public interface CartService {
    AddItemResp AddItem(AddItemReq);

    GetCartResp GetCart(GetCartReq);

    EmptyCartResp EmptyCart(EmptyCartReq);
}
```

## 5、订单服务

```java
import java.util.List;

class Address {
    String streetAddress;
    String city;
    String state;
    String country;
    Integer zipCode;
}

class PlaceOrderReq {
    Integer user_id;
    String user_currency;

    Address address;
    String email;
    List<OrderItem> orderItems;
}

class OrderItem {
    cart.CartItem item;
    Float cost;
}

class OrderResult {
    String orderId = 1;
}

class PlaceOrderResp {
    OrderResult order;
}

class ListOrderReq {
    Integer userId;
}

class Order {
    List<OrderItem> orderItems;
    string orderId;
    Integer userId;
    String userCurrency;
    Address address;
    String email;
    Integer createdAt;
}

class ListOrderResp {
    List<Order> orders;
}

class MarkOrderPaidReq {
    Integer userId;
    String ordeId;
}

class MarkOrderPaidResp {

}

public interface OrderService {
    PlaceOrderResp PlaceOrder(PlaceOrderReq);

    ListOrderResp ListOrder(ListOrderReq);

    MarkOrderPaidResp MarkOrderPaid(MarkOrderPaidReq);
}
```

## 6、结算服务

```java
class Address {
    String streetAddress;
    String city;
    String state;
    String country;
    String zipCode;
}

class CheckoutReq {
    Integer userId;
    String firstName;
    String lastName;
    String email;
    Address address;
    payment.CreditCardInfo creditCard;
}

class CheckoutResp {
    String orderId;
    String transactionId;
}

public interface CheckoutService {
    CheckoutResp Checkout(CheckoutReq);
}
```

## 7、支付服务

```java
class CreditCardInfo {
    String creditCardNumber;
    Integer creditCardCvv;
    Integer creditCardExpirationYear;
    Integer creditCardExpirationMonth;
}

class ChargeReq {
    Float amount;
    CreditCardInfo creditCard;
    String orderId;
    Integer userId;
}

class ChargeResp {
    String transactionId;
}

public interface PaymentService {
    ChargeResp Charge(ChargeReq);
}
```